<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout}">

<head>
    <th:block layout:fragment="head">
        <title>Editar Cliente</title>
    </th:block>
</head>

<body>
    <div layout:fragment="content">
        <div class="container mt-4">
            <h2>Editar Cliente</h2>

            <!-- Mensajes -->
            <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
            <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

            <form th:action="@{'/cliente/actualizar/' + ${cliente.codCliente}}" method="post">
                <div th:switch="${cliente.getClass().getSimpleName()}">
                    <!-- Cliente Natural -->
                    <div th:case="'ClienteNatural'">
                        <input type="hidden" name="tipo" value="NATURAL" />

                        <div class="mb-3">
                            <label>DNI</label>
                            <input type="text" class="form-control" name="dni" th:value="${cliente.persona.dni}"
                                required>
                        </div>
                        <div class="mb-3">
                            <label>Nombres</label>
                            <input type="text" class="form-control" name="nombres" th:value="${cliente.persona.nombres}"
                                required>
                        </div>
                        <div class="mb-3">
                            <label>Apellidos</label>
                            <input type="text" class="form-control" name="apellidos"
                                th:value="${cliente.persona.apellidos}" required>
                        </div>
                        <div class="mb-3">
                            <label>Correo</label>
                            <input type="email" class="form-control" name="correo" th:value="${cliente.persona.correo}">
                        </div>
                        <div class="mb-3">
                            <label>Teléfono</label>
                            <input type="text" class="form-control" name="telefono"
                                th:value="${cliente.persona.telefono}">
                        </div>
                        <div class="mb-3">
                            <label>Dirección</label>
                            <input type="text" class="form-control" name="direccion"
                                th:value="${cliente.persona.direccion}">
                        </div>
                    </div>

                    <!-- Cliente Jurídico -->
                    <div th:case="'ClienteJuridico'">
                        <input type="hidden" name="tipo" value="JURIDICO" />

                        <div class="mb-3">
                            <label>RUC</label>
                            <input type="text" class="form-control" name="ruc" th:value="${cliente.empresa.ruc}"
                                required>
                        </div>
                        <div class="mb-3">
                            <label>Razón Social</label>
                            <input type="text" class="form-control" name="razonSocial"
                                th:value="${cliente.empresa.razonSocial}" required>
                        </div>
                        <div class="mb-3">
                            <label>Correo</label>
                            <input type="email" class="form-control" name="correo" th:value="${cliente.empresa.correo}">
                        </div>
                        <div class="mb-3">
                            <label>Teléfono</label>
                            <input type="text" class="form-control" name="telefono"
                                th:value="${cliente.empresa.telefono}">
                        </div>
                        <div class="mb-3">
                            <label>Dirección</label>
                            <input type="text" class="form-control" name="direccion"
                                th:value="${cliente.empresa.direccion}">
                        </div>
                        <div class="mb-3">
                            <label>Nombre Comercial</label>
                            <input type="text" class="form-control" name="nombreComercial"
                                th:value="${cliente.empresa.nombreComercial}">
                        </div>
                    </div>
                </div>

                <!-- Categoría -->
                <div class="mb-3">
                    <label>Categoría</label>
                    <select name="idCategoriaCliente" class="form-select" required>
                        <option th:each="cat : ${categorias}" th:value="${cat.idCategoriaCliente}"
                            th:text="${cat.descripcion}"
                            th:selected="${cliente.categoriaCliente.idCategoriaCliente == cat.idCategoriaCliente}">
                        </option>
                    </select>
                </div>

                <div class="d-flex justify-content-between">
                    <a th:href="@{/cliente}" class="btn btn-secondary">Cancelar</a>
                    <button type="submit" class="btn btn-primary">Actualizar Cliente</button>
                </div>
            </form>
        </div>
    </div>
</body>

</html>